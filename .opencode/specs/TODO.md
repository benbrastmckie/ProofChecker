# TODO

**Last Updated:** 2025-12-29T00:50:44Z

## Overview

- **Total Tasks:** 24
- **Completed:** 4
- **High Priority:** 7
- **Medium Priority:** 8
- **Low Priority:** 10

---

## High Priority

### 229. Review and optimize orchestrator-command integration for context efficiency
- **Effort**: 6-8 hours
- **Status**: [NOT STARTED]
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - .opencode/agent/orchestrator.md
  - .opencode/command/research.md
  - .opencode/command/plan.md
  - .opencode/command/implement.md
  - .opencode/command/revise.md
  - .opencode/command/review.md
  - .opencode/context/common/workflows/command-lifecycle.md
  - .opencode/context/common/standards/subagent-return-format.md
- **Description**: ARCHITECTURAL REVIEW - Systematic analysis reveals critical architectural issue: orchestrator.md Step 4 (PrepareRouting) routes directly to SUBAGENTS (lean-research-agent, task-executor, planner, etc.) instead of routing to COMMANDS (research.md, plan.md, implement.md). This bypasses command-level context loading, workflow execution, preflight/postflight procedures, and status-sync-manager delegation. Root cause of task 228 (/plan bypasses postflight). **PROBLEM**: Current flow is User → Orchestrator → Subagent (direct). **EXPECTED**: User → Orchestrator → Command → Subagent. Commands contain the complete 8-stage workflow specification with context loading, validation, status updates, git commits. Subagents are implementation tools, not entry points. **CRITICAL IMPACTS**: (1) Context bloat - orchestrator loads context meant for commands, (2) Missing preflight/postflight - status updates fail (task 227, 228), (3) No command lifecycle - validation, git commits skipped, (4) Architecture violation - subagents exposed as primary delegation targets. **OPTIMIZATION OPPORTUNITIES**: (1) Orchestrator should have minimal context - only delegation registry, routing logic, return validation. Commands handle domain-specific context. (2) Commands should load exactly their needed context (Level 2 filtered by language). (3) Subagents should receive only task-specific context from commands. (4) Return validation should happen at orchestrator, not duplicated in commands. (5) Language routing should be command responsibility, not orchestrator. **FIX STRATEGY**: (1) Refactor orchestrator Step 7 (RouteToAgent) to invoke COMMANDS not SUBAGENTS. (2) Move language extraction and routing logic INTO commands (belongs in command Stage 2). (3) Reduce orchestrator context to core standards only (return format, delegation guide, status markers). (4) Let commands handle their own context loading via context_level specification. (5) Update all commands to be invokable by orchestrator (not just by users). (6) Ensure commands delegate to subagents internally (command-lifecycle.md Stage 4). **EXPECTED OUTCOMES**: (1) 60-70% reduction in orchestrator context window, (2) 100% workflow completion (preflight + postflight), (3) Clear architectural layers (orchestrator → command → subagent), (4) Context loaded exactly where needed, (5) No duplication of routing/validation logic, (6) All status updates via status-sync-manager, (7) Proper git commit integration, (8) Resolves task 228 root cause architecturally.
- **Acceptance Criteria**:
  - [ ] Root cause analysis documented: orchestrator routes to subagents instead of commands
  - [ ] Architecture diagram created showing correct flow: User → Orchestrator → Command → Subagent
  - [ ] All orchestrator routing targets audited (/research, /plan, /implement, /revise, /review, /errors)
  - [ ] Orchestrator Step 7 refactored to invoke commands (not subagents)
  - [ ] Language extraction logic moved from orchestrator to commands (Stage 2)
  - [ ] Routing logic moved from orchestrator to commands (Stage 2)
  - [ ] Orchestrator context reduced to: return-format.md, delegation-guide.md, status-markers.md only
  - [ ] Commands updated to be invokable by orchestrator (accept delegation context)
  - [ ] Commands updated to delegate to subagents internally (Stage 4 DelegateToSubagent)
  - [ ] context_level specifications verified for all commands (Level 2 filtered context)
  - [ ] Duplicate routing logic removed from orchestrator and commands
  - [ ] Return validation remains in orchestrator (single source of truth)
  - [ ] Preflight/postflight procedures execute for all commands
  - [ ] status-sync-manager invoked correctly in all command postflights
  - [ ] Git commits execute correctly via git-workflow-manager
  - [ ] Context window measurements before/after documented
  - [ ] Test: /research 197 executes full command lifecycle including postflight
  - [ ] Test: /plan 196 executes full command lifecycle including status update
  - [ ] Test: /implement 185 executes full command lifecycle with git commit
  - [ ] Test: Language routing works correctly (lean tasks → lean agents)
  - [ ] Test: Orchestrator context window reduced by 60-70%
  - [ ] Test: No command workflow stages skipped
  - [ ] Integration patterns documented in command-lifecycle.md
  - [ ] Task 228 resolved as side effect of architectural fix
- **Impact**: CRITICAL ARCHITECTURAL FIX - Resolves fundamental integration issue where orchestrator bypasses command layer, causing context bloat, missing workflow stages, and status update failures. Establishes correct 3-layer architecture (orchestrator → command → subagent) with clear separation of concerns. Reduces orchestrator context window by 60-70% by moving domain-specific context to commands. Ensures 100% workflow completion (preflight + postflight + status updates). Fixes root cause of tasks 227 and 228. Enables efficient context management where each layer loads only what it needs. Essential for scalable, maintainable agent system.

### ✅ 226. Fix /review command to use next_project_number, create matching task, include actionable follow-up tasks in summary, reduce verbosity, and improve context file organization
- **Effort**: 8 hours
- **Status**: [COMPLETED]
- **Started**: 2025-12-29
- **Completed**: 2025-12-29
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/226_fix_review_command/reports/research-001.md]
- **Plan**: [.opencode/specs/226_fix_review_command/plans/implementation-001.md]
- **Implementation Artifacts**:
  - Implementation Summary: [.opencode/specs/226_fix_review_command/summaries/implementation-summary-20251229.md]
  - Modified Files: .opencode/command/review.md, .opencode/agent/subagents/reviewer.md, .opencode/context/common/workflows/review.md
- **Files Affected**:
  - .opencode/command/review.md
  - .opencode/agent/subagents/reviewer.md
  - .opencode/context/common/workflows/review.md (potential cleanup/reorganization)
  - .opencode/specs/state.json
  - .opencode/specs/TODO.md
- **Description**: Fix multiple critical issues with /review command workflow: (1) **Project numbering bug**: /review created directory 225_codebase_review but task 225 already exists in TODO.md. Root cause: /review didn't read next_project_number from state.json before creating directory, and didn't increment it immediately after creation. Fix: Read next_project_number, use it for directory name, increment immediately (atomic operation). (2) **Missing task creation**: /review should create a task entry with the same number as the project directory, with status [COMPLETED] and link to review summary artifact. This enables tracking reviews as completed work in TODO.md. (3) **Summary lacks actionable follow-ups**: Review summary artifact (.opencode/specs/225_codebase_review/summaries/review-summary.md) lists 5 follow-up tasks but doesn't format them in a way that /task can parse to create actual task entries. Fix: Add explicit "Follow-up Tasks" section with task descriptions formatted for easy /task invocation (e.g., "/task 'Fix 6 noncomputable errors...'"). (4) **Excessive verbosity**: /review subagent returns verbose output to orchestrator, bloating context window. Fix: Return only brief summary (2-5 sentences, <100 tokens) with artifact path. Full details in summary artifact. (5) **Context file organization**: .opencode/context/common/workflows/review.md may contain redundancy, inaccuracy, or scattered organization. Audit and improve to avoid bloating context or missing important context. Ensure exactly the right context files are loaded.
- **Acceptance Criteria**:
  - [ ] Root cause analysis completed for project numbering bug
  - [ ] /review reads next_project_number from state.json before creating directory
  - [ ] /review creates directory using next_project_number (e.g., 226_codebase_review)
  - [ ] /review increments next_project_number immediately after directory creation (atomic)
  - [ ] /review creates TODO.md task entry with same number as project directory
  - [ ] Created task has status [COMPLETED] with completion timestamp
  - [ ] Created task includes link to review summary artifact
  - [ ] Review summary artifact includes explicit "Follow-up Tasks" section
  - [ ] Follow-up tasks formatted for direct /task invocation (copy-paste ready)
  - [ ] Each follow-up task includes: description, priority, language, estimated hours
  - [ ] /review subagent returns brief summary only (<100 tokens) to orchestrator
  - [ ] Full review details remain in summary artifact (not in return to orchestrator)
  - [ ] Context file audit completed (.opencode/context/common/workflows/review.md)
  - [ ] Redundant or inaccurate content removed from context files
  - [ ] Context loading optimized - exactly the right files loaded, no bloat
  - [ ] Test: /review creates directory with correct next_project_number
  - [ ] Test: /review creates matching TODO.md task with [COMPLETED] status
  - [ ] Test: Review summary includes actionable follow-up tasks
  - [ ] Test: /review return to orchestrator is brief (<100 tokens)
  - [ ] Test: Full review details available in summary artifact
  - [ ] Documentation updated with new /review behavior
  - [ ] No project number collisions occur
  - [ ] next_project_number increments correctly after each /review
- **Impact**: CRITICAL - Fixes project numbering collision bug that created 225_codebase_review when task 225 already existed. Enables tracking reviews as completed tasks in TODO.md. Makes review findings actionable by formatting follow-up tasks for easy /task invocation. Reduces context window bloat by returning only brief summaries to orchestrator. Improves context file organization to load exactly the right context without redundancy. Essential for reliable /review command execution and proper project tracking.

### 227. Fix systematic status-sync-manager TODO.md update failures across all workflow commands
- **Effort**: 6-8 hours
- **Status**: [RESEARCHED]
- **Started**: 2025-12-29
- **Completed**: 2025-12-29
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/227_fix_systematic_status_sync_manager_failures/reports/research-001.md]
- **Files Affected**:
  - .opencode/agent/subagents/status-sync-manager.md
  - .opencode/command/research.md
  - .opencode/command/plan.md
  - .opencode/command/revise.md
  - .opencode/command/implement.md
  - .opencode/agent/subagents/researcher.md
  - .opencode/agent/subagents/planner.md
  - .opencode/agent/subagents/lean-research-agent.md
  - .opencode/agent/subagents/lean-implementation-agent.md
  - .opencode/context/common/workflows/command-lifecycle.md
  - .opencode/context/common/system/status-markers.md
- **Description**: CRITICAL BUG - Systematic investigation reveals that ALL workflow commands (/research, /plan, /revise, /implement) fail to properly update TODO.md task statuses despite successfully updating state.json. Example manifestation: /research 224 completed successfully, created research-001.md artifact, updated state.json to "status": "researched", created project state.json - BUT TODO.md still shows "- **Status**: [NOT STARTED]" instead of "- **Status**: [RESEARCHED]". This indicates status-sync-manager is either (1) not being invoked by commands despite specification in command files, (2) failing silently when invoked, or (3) completing state.json updates but failing TODO.md updates in the two-phase commit. Root cause analysis required to identify which commands delegate properly vs perform manual updates, which fail to invoke status-sync-manager, and whether status-sync-manager itself has bugs in TODO.md update logic. The fix must ensure 100% atomic updates across TODO.md + state.json + project state.json for all 4 workflow commands, with proper error handling, rollback on failures, and validation that updates actually complete. This is distinct from task 221 which addressed missing delegation - this task focuses on fixing the update mechanism itself when delegation occurs. Investigation steps: (1) Audit actual command execution vs specification to identify delegation gaps, (2) Review status-sync-manager TODO.md update logic for bugs, (3) Add validation that status-sync-manager actually completes TODO.md updates, (4) Implement comprehensive error handling and rollback, (5) Add logging to trace update failures, (6) Test with real tasks to verify 100% update success rate.
- **Acceptance Criteria**:
  - [ ] Root cause analysis completed identifying exact failure point (delegation gap vs status-sync-manager bug)
  - [ ] All 4 workflow commands audited for actual vs specified delegation to status-sync-manager
  - [ ] status-sync-manager TODO.md update logic reviewed and bugs fixed if found
  - [ ] Validation added that status-sync-manager actually completes TODO.md updates (not just state.json)
  - [ ] Error handling added to detect and report TODO.md update failures
  - [ ] Rollback mechanism verified to revert state.json if TODO.md update fails
  - [ ] Logging added to trace update flow and capture failure details
  - [ ] Test: /research task successfully updates both TODO.md and state.json to [RESEARCHED]
  - [ ] Test: /plan task successfully updates both TODO.md and state.json to [PLANNED]
  - [ ] Test: /revise task successfully updates both TODO.md and state.json to [REVISED]
  - [ ] Test: /implement task successfully updates both TODO.md and state.json to [COMPLETED]
  - [ ] Test: Rollback works - if TODO.md update fails, state.json reverted to original
  - [ ] Test: Clear error messages when updates fail identifying which file failed
  - [ ] 100% update success rate verified across all 4 commands with real task execution
  - [ ] No "status-sync-manager didn't update TODO.md" errors occur
  - [ ] Atomic guarantee enforced - both files update or neither updates
  - [ ] Documentation updated with proper delegation patterns and error handling
- **Impact**: CRITICAL BLOCKER - Fixes systematic status tracking failure affecting ALL workflow commands. Currently state.json reflects correct status but TODO.md remains stale, causing confusion about task progress, breaking workflow dependencies (tasks appear NOT STARTED when actually RESEARCHED/PLANNED), and violating atomic update guarantees. This breaks the entire task tracking system's integrity. Essential for reliable project management and workflow execution. Builds on task 221's delegation fixes to ensure updates actually work when delegated.

### 228. Fix orchestrator routing to invoke commands instead of bypassing to subagents directly
- **Effort**: TBD
- **Status**: [RESEARCHED]
- **Started**: 2025-12-29
- **Completed**: 2025-12-29
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/228_fix_orchestrator_routing_to_invoke_commands_instead_of_bypassing_to_subagents_directly/reports/research-001.md]
- **Files Affected**:
  - .opencode/agent/orchestrator.md
  - .opencode/command/plan.md
  - .opencode/command/research.md
  - .opencode/command/implement.md
  - .opencode/command/revise.md
- **Description**: The /plan command fails to update the task in TODO.md and does not include a link to the plan created. Root Cause: The orchestrator bypassed the /plan command layer and directly invoked the planner subagent, which meant the command's Stage 7 (Postflight) that delegates to status-sync-manager never executed, leaving TODO.md and state.json unupdated despite the plan artifact being successfully created. This is an architectural issue with the orchestrator's routing logic - it needs to invoke commands (which have full workflow specifications), not subagents directly. When a user invokes `/plan 224`, the orchestrator should route to the plan command (which has the complete 8-stage workflow including postflight status updates), not directly to the planner subagent. The correct delegation chain should be: User → Orchestrator → /plan COMMAND → planner subagent → status-sync-manager. Currently happening: User → Orchestrator → planner subagent (directly) → (no postflight, no status-sync-manager). Fix requires updating orchestrator's Stage 7 (RouteToAgent) to invoke command layer, which will then handle delegation to appropriate subagents and execute postflight procedures.
- **Acceptance Criteria**:
  - [ ] Root cause documented in orchestrator.md
  - [ ] Orchestrator Stage 7 modified to invoke commands, not subagents
  - [ ] /plan command invocation properly executes all 8 stages including postflight
  - [ ] /research command invocation properly executes all 8 stages including postflight
  - [ ] /implement command invocation properly executes all 8 stages including postflight
  - [ ] /revise command invocation properly executes all 8 stages including postflight
  - [ ] status-sync-manager properly invoked by commands after subagent completion
  - [ ] TODO.md correctly updated with status markers after command completion
  - [ ] state.json correctly updated with status and timestamps after command completion
  - [ ] Plan links correctly added to TODO.md after /plan completion
  - [ ] Test: /plan 224 updates TODO.md to [PLANNED] with plan link
  - [ ] Test: /research updates TODO.md to [RESEARCHED] with research links
  - [ ] Test: All workflow commands execute complete lifecycle
  - [ ] Documentation updated explaining command vs subagent delegation
- **Impact**: CRITICAL - Fixes systematic failure where workflow commands don't update TODO.md or state.json because orchestrator bypasses command layer (which contains postflight logic). This breaks task tracking for ALL workflow commands (/plan, /research, /implement, /revise). Essential architectural fix to ensure commands execute their full lifecycle including status updates via status-sync-manager.

 
### 185. Fix integration test helper API mismatches
- **Effort**: 1 hour
- **Status**: [IN PROGRESS]
- **Started**: 2025-12-25
- **Priority**: High
- **Language**: lean
- **Blocking**: None
- **Dependencies**: 183, 184
- **Files Affected**:
  - LogosTest/Core/Integration/Helpers.lean
- **Description**: Fix 3 API mismatches in integration test Helpers.lean that prevent test compilation after core build errors are fixed. Errors: Line 126 (semantic consequence type mismatch), Line 131 (validity unwrapping issue), Line 129 (unsolved goals in verify_workflow). These errors occur because test helpers assume an API that differs from the actual Logos implementation. **UPDATE (2025-12-28)**: Dependency task 184 now resolved by task 219 (Truth.lean compiles successfully). Task 183 (DeductionTheorem.lean) was completed separately. This task can now proceed once task 183 is verified complete.
- **Acceptance Criteria**:
  - [ ] Line 126 semantic consequence type mismatch fixed
  - [ ] Line 131 validity unwrapping issue fixed
  - [ ] Line 129 unsolved goals in verify_workflow fixed
  - [ ] Helpers.lean compiles successfully
  - [ ] All 146 integration tests compile successfully
  - [ ] All 146 integration tests pass with lake exe test
  - [ ] Test execution time is under 2 minutes
- **Impact**: Final step to unblock task 173. Once fixed, all 146 integration tests will compile and pass, delivering verified 82% integration test coverage and completing task 173. Dependency blocker task 184 now resolved by task 219.

### 224. Configure OpenCode to start in Orchestrator mode or auto-switch agent modes for workflow commands
- **Effort**: 2 hours (estimated from research)
- **Status**: [COMPLETED]
- **Started**: 2025-12-29
- **Completed**: 2025-12-29
- **Priority**: Medium
- **Language**: general
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/224_configure_opencode_default_agent/reports/research-001.md]
- **Plan**: [.opencode/specs/224_configure_opencode_default_agent/plans/implementation-001.md]
- **Implementation Artifacts**:
  - Implementation Summary: [.opencode/specs/224_configure_opencode_default_agent/summaries/implementation-summary-20251229.md]
  - Modified Files: opencode.json
- **Files Affected**:
  - opencode.json (potential agent configuration)
  - .opencode/rules/ (potential custom rules)
  - .opencode/command/*.md (potential command enhancements)
- **Description**: When starting OpenCode, it defaults to 'Build' agent mode. Users sometimes forget to switch to 'Orchestrator' before running workflow commands like /research or /implement, which can lead to commands being executed by the wrong agent. Research https://opencode.ai/docs/agents/, https://opencode.ai/docs/commands/, and https://opencode.ai/docs/rules/ to find an elegant solution that conforms to OpenCode best practices. Potential approaches: (1) Configure OpenCode to start in Orchestrator mode by default, (2) Make workflow commands automatically switch to the appropriate agent mode when invoked, (3) Add validation/warnings when commands are run in incorrect agent mode, (4) Use custom rules to enforce agent mode requirements. The solution should be minimally disruptive and follow OpenCode conventions.
- **Research Findings** (2025-12-29): Research completed analyzing OpenCode agent mode system, command routing, and custom rules. Found official `default_agent` config option in opencode.json that sets startup agent. Analyzed 4 solutions: (1) default_agent config (recommended - 1 line change), (2) command-level agent frontmatter routing (already implemented), (3) subagent invocation patterns (workflow-specific), (4) custom rules (overkill for this use case). **Recommended Solution**: Add `"default_agent": "orchestrator"` to opencode.json root level. This is the most elegant, minimally disruptive solution that follows OpenCode conventions and works across CLI, web, and IDE interfaces. Orchestrator agent already configured with `mode: 'all'` allowing it to be primary agent, and all workflow commands already specify `agent: orchestrator` in frontmatter for proper routing.
- **Acceptance Criteria**:
  - [ ] Research completed on OpenCode agent configuration options
  - [ ] Research completed on OpenCode command routing and agent mode switching
  - [ ] Research completed on OpenCode custom rules for agent mode enforcement
  - [ ] Viable solution identified that follows OpenCode best practices
  - [ ] Solution implemented (configuration changes, rule additions, or command enhancements)
  - [ ] OpenCode starts in Orchestrator mode by default OR workflow commands auto-switch to correct agent
  - [ ] No breaking changes to existing workflows
  - [ ] Solution tested with /research, /plan, /implement, /revise commands
  - [ ] Documentation updated explaining the agent mode behavior
  - [ ] User experience improved - no need to manually switch agent modes
- **Impact**: Improves user experience by eliminating the need to manually switch to Orchestrator mode before running workflow commands. Reduces errors from running commands in the wrong agent mode. Ensures commands are always executed by the appropriate agent without user intervention.

### 203. Add --complex flag to /research for subtopic subdivision with summary
- **Effort**: TBD
- **Status**: [NOT STARTED]
- **Priority**: Medium
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - .opencode/command/research.md
  - .opencode/agent/subagents/researcher.md
  - .opencode/agent/subagents/lean-research-agent.md
- **Description**: Enhance the /research command to support a --complex flag that changes its behavior for handling complex research topics. Without --complex flag: /research creates a single research report (reports/research-001.md) with no summary - this is the current default behavior. With --complex flag: /research should (1) Divide the topic into 1-5 appropriate subtopics using intelligent analysis, (2) Spawn research subagents to complete each subtopic in parallel, creating individual research reports (reports/research-001.md, reports/research-002.md, etc.), (3) Each subagent returns only its report path and brief summary (not full content) to the primary agent, (4) Primary agent compiles all report paths and brief summaries into a research summary report (summaries/research-summary.md), (5) Update TODO.md and state.json with all report references and mark task as [RESEARCHED]. The --complex flag enables comprehensive research on large topics while protecting context windows through summarization.
- **Acceptance Criteria**:
  - [ ] --complex flag added to /research command argument parsing
  - [ ] Without --complex: /research creates single report, no summary (current behavior preserved)
  - [ ] With --complex: Topic intelligently divided into 1-5 subtopics
  - [ ] With --complex: Separate research subagents spawned for each subtopic
  - [ ] With --complex: Each subtopic generates individual report (reports/research-NNN.md)
  - [ ] With --complex: Subagents return only report path + brief summary (not full content)
  - [ ] With --complex: Primary agent creates research summary (summaries/research-summary.md) compiling all references
  - [ ] Research summary contains only paths and brief summaries, not duplicated full content
  - [ ] Lazy directory creation followed (summaries/ created only when writing summary)
  - [ ] TODO.md updated with all report references and [RESEARCHED] status for both modes
  - [ ] state.json updated correctly for both modes
  - [ ] Documentation explains --complex flag behavior and use cases
- **Impact**: Enables comprehensive research on complex topics by dividing them into manageable subtopics while protecting the primary agent's context window through summarization. Provides flexibility - simple topics get focused single reports, complex topics get thorough multi-report coverage with summary overview.

### 132. Prove Lindenbaum maximal consistency lemma in Completeness.lean
- **Effort**: 3 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - Logos/Core/Metalogic/Completeness.lean
- **Description**: Formalize and prove the Lindenbaum maximal consistency lemma to eliminate the first axiom placeholder.
- **Acceptance Criteria**:
  - [ ] Lindenbaum lemma proven and axiom removed
  - [ ] Proof integrates with existing canonical model scaffolding
  - [ ] Related tests added or updated
- **Impact**: Unlocks subsequent completeness proofs by establishing maximal consistency.

### 133. Build canonical model constructors in Completeness.lean
- **Effort**: 3 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: 132
- **Files Affected**:
  - Logos/Core/Metalogic/Completeness.lean
- **Description**: Implement canonical model construction helpers and remove associated axiom stubs.
- **Acceptance Criteria**:
  - [ ] Canonical model constructors implemented
  - [ ] Corresponding axiom placeholders removed
  - [ ] Construction type-checks with existing definitions
- **Impact**: Provides the core model for subsequent truth lemma proofs.

### 134. Prove truth lemma structure in Completeness.lean
- **Effort**: 3 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: 133
- **Files Affected**:
  - Logos/Core/Metalogic/Completeness.lean
- **Description**: Prove the truth lemma for the canonical model, removing the corresponding axiom placeholder.
- **Acceptance Criteria**:
  - [ ] Truth lemma proven and axiom removed
  - [ ] Proof integrates with canonical model components
  - [ ] Tests (or placeholders) updated to exercise lemma
- **Impact**: Establishes the key bridge between syntax and semantics for completeness.

### 135. Remove provable_iff_valid sorry in Completeness.lean
- **Effort**: 2 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: 132, 133, 134
- **Files Affected**:
  - Logos/Core/Metalogic/Completeness.lean
- **Description**: Complete the `provable_iff_valid` theorem using the proven canonical model and truth lemma to eliminate the remaining sorry.
- **Acceptance Criteria**:
  - [ ] `provable_iff_valid` fully proven
  - [ ] No remaining axiom or sorry placeholders in Completeness.lean
  - [ ] Completeness tests added or updated
- **Impact**: Delivers full completeness, enabling derivability from validity.

### Decidability

### 136. Design Decidability.lean architecture and signatures
- **Effort**: 2 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - Logos/Core/Metalogic/Decidability.lean
- **Description**: Define the module structure, main theorems, and function signatures for decidability (tableau and satisfiability checks).
- **Acceptance Criteria**:
  - [ ] Module skeleton with signatures for tableau and decision procedures
  - [ ] Documentation comments outline intended algorithms
  - [ ] No build warnings from new declarations
- **Impact**: Establishes a foundation for future decidability proofs and implementations.

### 137. Implement tableau core rules in Decidability.lean
- **Effort**: 3 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: 136
- **Files Affected**:
  - Logos/Core/Metalogic/Decidability.lean
- **Description**: Implement the core tableau expansion rules and supporting helpers for validity checking.
- **Acceptance Criteria**:
  - [ ] Tableau expansion rules implemented and type-checking
  - [ ] Basic examples compile demonstrating rule application
  - [ ] No placeholder axioms for these rules remain
- **Impact**: Provides executable building blocks for the decision procedure.

### 138. Implement satisfiability and validity decision procedure tests
- **Effort**: 3 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: lean
- **Blocking**: None
- **Dependencies**: 136, 137
- **Files Affected**:
  - Logos/Core/Metalogic/Decidability.lean
  - LogosTest/Metalogic/DecidabilityTest.lean (new or updated)
- **Description**: Wire the tableau components into a decision procedure and add tests covering satisfiable and unsatisfiable cases.
- **Acceptance Criteria**:
  - [ ] Decision procedure implemented and compiles
  - [ ] Tests cover satisfiable and unsatisfiable scenarios
  - [ ] No remaining placeholder axioms in the decision procedure path
- **Impact**: Delivers an initial, test-backed decision procedure for TM logic.

### Layer Extensions (Future Planning)

### 139. Draft Layer 1 counterfactual operator plan
- **Effort**: 2 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - Documentation/UserGuide/ARCHITECTURE.md
  - Documentation/UserGuide/METHODOLOGY.md
- **Description**: Draft a plan for Layer 1 counterfactual operators, defining `box_c` and `diamond_m` semantics and integration points.
- **Acceptance Criteria**:
  - [ ] Draft plan describing operators, semantics, and required modules
  - [ ] Architecture updated with Layer 1 scope and assumptions
  - [ ] Clear follow-on tasks identified
- **Impact**: Provides roadmap for counterfactual extensions post Layer 0.

### 140. Draft Layer 2 epistemic operator plan
- **Effort**: 2 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - Documentation/UserGuide/ARCHITECTURE.md
  - Documentation/UserGuide/METHODOLOGY.md
- **Description**: Draft a plan for Layer 2 epistemic operators (`K`, `B`) including semantics and proof obligations.
- **Acceptance Criteria**:
  - [ ] Draft plan outlines semantics, target theorems, and module impacts
  - [ ] Architecture updated with Layer 2 scope and assumptions
  - [ ] Follow-on tasks identified
- **Impact**: Establishes roadmap for epistemic extensions.

### 141. Draft Layer 3 normative operator plan
- **Effort**: 2 hours
- **Status**: [NOT STARTED]
- **Priority**: Low
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - Documentation/UserGuide/ARCHITECTURE.md
  - Documentation/UserGuide/METHODOLOGY.md
- **Description**: Draft a plan for Layer 3 normative operators (`O`, `P`) including semantics and proof obligations.
- **Acceptance Criteria**:
  - [ ] Draft plan outlines semantics, target theorems, and module impacts
  - [ ] Architecture updated with Layer 3 scope and assumptions
  - [ ] Follow-on tasks identified
- **Impact**: Provides a roadmap for normative logic extensions.

---


### 175. Establish CI/CD pipeline with automated testing and linting
- **Effort**: 13 hours
- **Status**: [NOT STARTED]
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - .github/workflows/ci.yml (new)
  - .github/workflows/lint.yml (new)
  - .github/workflows/coverage.yml (new)
  - Documentation/Development/CI_CD_PROCESS.md (new)
- **Description**: Create GitHub Actions workflows for continuous integration and deployment. Currently all tests run manually. CI/CD pipeline should run tests, linting, style checks, coverage reporting, and documentation build checks automatically on every pull request and commit.
- **Acceptance Criteria**:
  - [ ] GitHub Actions workflow for tests created and passing
  - [ ] Linting and style checks integrated into CI
  - [ ] Coverage reporting integrated into CI
  - [ ] Documentation build checks integrated into CI
  - [ ] CI runs on all pull requests and commits to main
  - [ ] CI failure blocks merge
  - [ ] CI/CD process documented in CI_CD_PROCESS.md
- **Impact**: Ensures code quality automatically, prevents regressions, and enables confident merging of pull requests. Essential for maintaining production-ready code.

### 176. Enhance proof search with domain-specific heuristics and caching
- **Effort**: 18 hours
- **Status**: [NOT STARTED]
- **Priority**: Medium
- **Language**: lean
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - Logos/Core/Automation/ProofSearch.lean
  - Logos/Core/Automation/ProofSearchHeuristics.lean (new)
  - Logos/Core/Automation/ProofCache.lean (new)
  - LogosTest/Core/Automation/ProofSearchHeuristicsTest.lean (new)
- **Description**: Enhance ProofSearch.lean with modal-specific and temporal-specific heuristics, proof caching with hash-consing, and success pattern learning. Current heuristics are basic (Task 127 complete). Domain-specific optimizations will significantly improve proof search effectiveness.
- **Acceptance Criteria**:
  - [ ] Modal-specific heuristics implemented (prefer S5 axioms for modal goals)
  - [ ] Temporal-specific heuristics implemented (prefer temporal axioms for temporal goals)
  - [ ] Proof caching with hash-consing implemented
  - [ ] Success pattern learning implemented
  - [ ] Heuristics tested and benchmarked
  - [ ] Documentation for heuristic tuning added
- **Impact**: Improves automation effectiveness by tailoring proof search to the structure of modal and temporal problems, reducing search time and increasing success rate.

### 178. Complete advanced tutorial sections with hands-on exercises
- **Effort**: 13 hours
- **Status**: [NOT STARTED]
- **Priority**: Medium
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: 172
- **Files Affected**:
  - Documentation/UserGuide/TUTORIAL.md
  - Documentation/UserGuide/TUTORIAL_EXERCISES.md (new)
  - Documentation/UserGuide/TROUBLESHOOTING.md (new)
- **Description**: Enhance TUTORIAL.md with advanced sections on proof search automation, custom tactic development, and metalogic. Add hands-on exercises with solutions and a troubleshooting guide. Current tutorial is basic and lacks advanced topics.
- **Acceptance Criteria**:
  - [ ] Advanced tutorial section on proof search and automation added
  - [ ] Advanced tutorial section on custom tactic development added
  - [ ] Advanced tutorial section on metalogic and soundness added
  - [ ] Hands-on exercises with solutions added
  - [ ] Troubleshooting guide created
  - [ ] Tutorial tested with new users for clarity
- **Impact**: Improves onboarding by providing comprehensive learning path from basics to advanced topics with practical exercises.

### 179. Implement performance benchmarks for proof search and derivation
- **Effort**: 13 hours
- **Status**: [NOT STARTED]
- **Priority**: Medium
- **Language**: lean
- **Blocking**: None
- **Dependencies**: None
- **Files Affected**:
  - LogosBench/ (new directory)
  - LogosBench/ProofSearchBench.lean (new)
  - LogosBench/DerivationBench.lean (new)
  - LogosBench/SemanticEvaluationBench.lean (new)
  - Documentation/Development/PERFORMANCE_TARGETS.md (new)
- **Description**: Create performance benchmark suite for proof search, derivation, and semantic evaluation. Add performance regression testing to CI. Currently no benchmarks exist and performance could regress unnoticed. Document performance targets.
- **Acceptance Criteria**:
  - [ ] Benchmark suite for proof search created
  - [ ] Benchmark suite for derivation created
  - [ ] Benchmark suite for semantic evaluation created
  - [ ] Performance regression testing added to CI
  - [ ] Performance targets documented
  - [ ] Baseline performance measurements recorded
- **Impact**: Ensures performance doesn't regress and provides data for optimization efforts. Critical for maintaining usable proof search times.

### 180. Add test coverage metrics and reporting
- **Effort**: 9 hours
- **Status**: [NOT STARTED]
- **Priority**: Medium
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: 175
- **Files Affected**:
  - .github/workflows/coverage.yml
  - scripts/GenerateCoverage.lean (new)
  - Documentation/Development/TEST_COVERAGE.md (new)
- **Description**: Integrate test coverage measurement tool, generate coverage reports, add coverage reporting to CI, and create coverage improvement plan. TESTING_STANDARDS.md defines target of at least 85 percent but no measurement exists.
- **Acceptance Criteria**:
  - [ ] Coverage measurement tool integrated
  - [ ] Coverage reports generated automatically
  - [ ] Coverage reporting integrated into CI
  - [ ] Coverage improvement plan created
  - [ ] Coverage measurement process documented
  - [ ] Current coverage baseline established
- **Impact**: Enables data-driven test improvement by identifying untested code paths and tracking coverage over time.

### 189. Add --divide flag to /research command for topic subdivision
- **Effort**: 3 hours
- **Status**: [IN PROGRESS]
- **Started**: 2025-12-26
- **Priority**: Medium
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/189_research_divide_flag/reports/research-001.md]
  - Summary: [.opencode/specs/189_research_divide_flag/summaries/research-summary.md]
- **Files Affected**:
  - .opencode/command/research.md
  - .opencode/agent/subagents/researcher.md
  - .opencode/agent/subagents/specialists/web-research-specialist.md
- **Description**: Add a --divide flag to the /research command that changes its behavior. Without --divide, /research should create individual research reports only (no research summary). With --divide, /research should invoke a subagent to divide the research topic into natural subtopics, pass each subtopic to further research subagents to research and create individual reports, then compile the references and brief summaries into a research summary report. The research summary should contain only references to the individual reports and their brief summaries, not duplicate the full content.
- **Acceptance Criteria**:
  - [ ] --divide flag added to /research command documentation and input parsing
  - [ ] Without --divide: /research creates only individual research reports (reports/research-NNN.md), no summary
  - [ ] With --divide: /research divides topic into subtopics using a subagent
  - [ ] With --divide: Each subtopic is researched by a separate subagent, creating individual reports
  - [ ] With --divide: Research summary report (summaries/research-summary.md) is created compiling references and brief summaries
  - [ ] Research summary contains only references and brief summaries, not full content
  - [ ] All behavior follows lazy directory creation (create summaries/ only when writing summary)
  - [ ] Status markers and state sync work correctly for both modes
  - [ ] Documentation updated to explain --divide flag behavior
- **Impact**: Provides more flexible research workflow - simple research creates focused reports without overhead of summary compilation, while complex research can be divided into manageable subtopics with a summary overview.


### 222. Investigate and fix artifact creation in /specs instead of /.opencode/specs ✅
- **Effort**: 3 hours
- **Status**: [COMPLETED]
- **Started**: 2025-12-28
- **Planned**: 2025-12-28
- **Completed**: 2025-12-28
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/222_investigate_artifact_path_errors/reports/research-001.md]
- **Plan**: [.opencode/specs/222_investigate_artifact_path_errors/plans/implementation-001.md] (created 2025-12-28)
- **Plan Summary**: 6-phase implementation (3 hours total). Phase 1: Fix lean-research-agent.md incorrect path pattern (line 497). Phase 2: Migrate project 213 as test case. Phase 3: Migrate projects 215 and 218. Phase 4: Update state.json references. Phase 5: Cleanup and verification. Phase 6: Integration testing and documentation. Root cause: specs/{task_slug} instead of .opencode/specs/{task_slug}.
- **Implementation Artifacts**:
  - lean-research-agent.md: [.opencode/agent/subagents/lean-research-agent.md] (fixed 4 path patterns)
  - Implementation Summary: [.opencode/specs/222_investigate_artifact_path_errors/summaries/implementation-summary-20251228.md]
- **Description**: Artifacts have started to be created in /home/benjamin/Projects/ProofChecker/specs/ instead of /home/benjamin/Projects/ProofChecker/.opencode/specs/. Investigate the root cause and which commands and subagents are responsible in order to implement a systematic fix to these issues. Confirmed affected project directories: 213_resolve_is_valid_swap_involution_blocker, 215_fix_todo_command_task_block_removal, 218_fix_lean_lsp_mcp_integration_and_opencode_module_import_errors. All artifacts should be created under .opencode/specs/ per artifact management standards.
- **Acceptance Criteria**:
  - [ ] Root cause identified - which commands/subagents use wrong path
  - [ ] Audit completed of all workflow commands (research, plan, revise, implement, review)
  - [ ] Audit completed of all subagents (researcher, planner, implementer, task-executor, lean-implementation-agent, lean-research-agent, reviewer)
  - [ ] Path generation logic analyzed in artifact-management.md and command-lifecycle.md
  - [ ] All incorrect path references identified and documented
  - [ ] Fix implemented for all commands and subagents using wrong paths
  - [ ] Validation that all artifacts now create under .opencode/specs/
  - [ ] Existing misplaced artifacts moved to correct location
  - [ ] state.json artifact paths updated to reflect correct locations
  - [ ] Testing with real tasks confirms correct path usage
  - [ ] Documentation updated with correct path standards
- **Impact**: CRITICAL - Ensures all artifacts are created in the standardized .opencode/specs/ location per artifact management standards. Fixes systematic path errors that create artifacts in the wrong directory, preventing confusion and ensuring proper artifact tracking.

### ✓ 220. Ensure all commands and agents comply with metadata passing standards for artifact management
- **Effort**: 2.5 hours
- **Status**: [COMPLETED]
- **Started**: 2025-12-28
- **Planned**: 2025-12-28
- **Planned**: 2025-12-28
- **Priority**: Medium
- **Language**: markdown
- **Research Artifacts**:
  - Main Report: [.opencode/specs/220_metadata_passing_compliance_verification/reports/research-001.md]
- **Plan**: [.opencode/specs/220_metadata_passing_compliance_verification/plans/implementation-001.md]
- **Plan Summary**: 6-phase implementation (2.5 hours total). Phase 1-2: Complete documentation review of lean-research-agent and lean-implementation-agent. Phase 3-4: Add defensive validation to planner and enhance task-executor error messages. Phase 5: Create compliance verification report. Phase 6: Final validation and documentation. Achieves 100% compliance (up from 94%) across all 10 files with 3 minor gaps resolved.
- **Implementation Artifacts**:
  - Compliance Verification Report: [.opencode/specs/220_metadata_passing_compliance_verification/summaries/compliance-verification-report.md]
  - Implementation Summary: [.opencode/specs/220_metadata_passing_compliance_verification/summaries/implementation-summary-20251228.md]
  - Updated Files: .opencode/agent/subagents/lean-research-agent.md, .opencode/agent/subagents/lean-implementation-agent.md, .opencode/agent/subagents/planner.md, .opencode/agent/subagents/task-executor.md
- **Blocking**: None
- **Dependencies**: 217
- **Files Affected**:
  - .opencode/context/common/system/artifact-management.md
  - .opencode/context/common/workflows/command-lifecycle.md
  - .opencode/command/research.md
  - .opencode/command/plan.md
  - .opencode/command/revise.md
  - .opencode/command/implement.md
  - .opencode/agent/subagents/researcher.md
  - .opencode/agent/subagents/planner.md
  - .opencode/agent/subagents/lean-research-agent.md
  - .opencode/agent/subagents/lean-implementation-agent.md
  - .opencode/agent/subagents/task-executor.md
  - .opencode/agent/subagents/implementer.md
- **Description**: Task 217 is responsible for revising the context files and documentation surrounding the metadata passing strategies, ensuring consistent and systematic treatment of artifacts where their references and brief summaries are returned to the primary agent to avoid bloating the primary agent's context window. This task ensures that all commands and agents are fully compliant with these standards, maintaining a clear and uniform approach. After task 217 completes its documentation revisions, this task will verify and enforce compliance across all workflow commands (research, plan, revise, implement) and their delegated subagents (researcher, planner, lean-research-agent, lean-implementation-agent, task-executor, implementer). The goal is to ensure: (1) All agents return only artifact references and brief summaries (not full content) per the updated metadata passing standards, (2) All commands properly receive and handle these brief returns without requesting full artifact content, (3) Context window protection is consistently enforced across all workflows, (4) Artifact references use standardized formats (absolute paths, correct naming conventions), (5) Brief summaries meet the defined constraints (token limits, content requirements), (6) No regression or inconsistency in artifact management practices. This task depends on task 217 completing its context file revisions first.
- **Acceptance Criteria**:
  - [ ] Task 217 context file revisions completed (prerequisite)
  - [ ] All 4 commands reviewed for compliance with updated metadata passing standards
  - [ ] All 6 subagents reviewed for compliance with updated metadata passing standards
  - [ ] Each agent verified to return only artifact references + brief summaries (not full content)
  - [ ] Each command verified to accept brief returns without requesting full content
  - [ ] Artifact reference formats standardized (absolute paths, correct naming)
  - [ ] Brief summary constraints verified (token limits, content requirements)
  - [ ] Context window protection consistently enforced across all workflows
  - [ ] Compliance gaps identified and documented
  - [ ] Fixes implemented for all non-compliant commands and agents
  - [ ] Test verification with real tasks for all 4 commands
  - [ ] No regression in artifact creation or quality
  - [ ] Documentation updated to reflect compliance requirements
- **Impact**: Ensures systematic compliance with metadata passing standards across all workflow commands and agents, protecting the primary agent's context window from bloat while maintaining clear and uniform artifact management practices. Builds on task 217's documentation work to achieve full system-wide compliance.

### ✓ 221. Fix comprehensive status update failures - ensure atomic updates across TODO.md, state.json, project state.json, and plans via status-sync-manager
- **Effort**: 8-10 hours
- **Status**: [COMPLETED]
- **Started**: 2025-12-28
- **Planned**: 2025-12-28
- **Priority**: High
- **Language**: markdown
- **Blocking**: None
- **Dependencies**: None
- **Research Artifacts**:
  - Main Report: [.opencode/specs/221_fix_comprehensive_status_update_failures/reports/research-001.md]
- **Plan**: [.opencode/specs/221_fix_comprehensive_status_update_failures/plans/implementation-001.md]
- **Implementation Artifacts**:
  - Implementation Summary: [.opencode/specs/221_fix_comprehensive_status_update_failures/summaries/implementation-summary-20251228.md]
  - Modified Files: .opencode/agent/subagents/task-executor.md, .opencode/agent/subagents/status-sync-manager.md, .opencode/command/implement.md, .opencode/context/common/workflows/command-lifecycle.md
- **Files Affected**:
  - .opencode/command/research.md
  - .opencode/command/plan.md
  - .opencode/command/revise.md
  - .opencode/command/implement.md
  - .opencode/agent/subagents/researcher.md
  - .opencode/agent/subagents/planner.md
  - .opencode/agent/subagents/lean-research-agent.md
  - .opencode/agent/subagents/lean-implementation-agent.md
  - .opencode/agent/subagents/task-executor.md
  - .opencode/agent/subagents/implementer.md
  - .opencode/agent/subagents/status-sync-manager.md
  - .opencode/context/common/workflows/command-lifecycle.md
  - .opencode/context/common/system/status-markers.md
  - .opencode/context/common/system/state-schema.md
- **Description**: Fix comprehensive status update failures manifested by error "status-sync-manager didn't actually update TODO.md" and similar issues. Root cause analysis reveals THREE critical problems: (1) **Inconsistent delegation**: Commands don't consistently delegate to status-sync-manager - some perform manual updates, some skip updates entirely, some delegate only partially. This causes partial updates where state.json updates but TODO.md doesn't, or vice versa. (2) **Missing project state.json creation**: Project-specific state.json files (.opencode/specs/{task_number}_{slug}/state.json) are never created despite being required by state-schema.md for tracking artifacts, plan metadata, and plan versions. This violates the lazy creation policy and prevents proper artifact tracking. (3) **No plan file updates**: When /implement executes phases, plan files are never updated with phase statuses ([IN PROGRESS] → [COMPLETED]), preventing progress tracking and breaking the atomic update guarantee. Investigation found that status-sync-manager has full capabilities (artifact validation protocol, plan metadata tracking, project state.json lazy creation, plan version history) but commands bypass it with manual updates. Fix requires: (A) Audit all 4 workflow commands (/research, /plan, /revise, /implement) to identify where manual updates occur instead of status-sync-manager delegation, (B) Remove ALL manual TODO.md/state.json/plan file updates from commands, (C) Ensure ALL status updates delegate to status-sync-manager with complete parameters (validated_artifacts, plan_metadata, plan_version, phase_statuses), (D) Verify status-sync-manager receives all required inputs to perform atomic two-phase commit across TODO.md + state.json + project state.json + plan file, (E) Add validation that status-sync-manager actually completes updates (check return status), (F) Add error handling for status-sync-manager failures with rollback and clear user error messages, (G) Ensure ...
- **Acceptance Criteria**:
  - [x] Root cause analysis completed documenting all 3 critical problems with specific examples
  - [x] All 4 workflow commands audited identifying manual update locations
  - [x] Manual TODO.md updates removed from all 4 commands
  - [x] Manual state.json updates removed from all 4 commands
  - [x] Manual plan file updates removed from /implement command
  - [x] /research command delegates all updates to status-sync-manager with validated_artifacts parameter
  - [x] /plan command delegates all updates to status-sync-manager with validated_artifacts and plan_metadata parameters
  - [x] /revise command delegates all updates to status-sync-manager with plan_version and revision_reason parameters
  - [x] /implement command delegates all updates to status-sync-manager with plan_path and phase_statuses parameters
  - [x] All commands validate status-sync-manager return status (completed vs failed)
  - [x] Error handling added for status-sync-manager failures with rollback and user error messages
  - [x] Project state.json lazy creation triggers verified for /research, /plan, /implement on first artifact
  - [x] Plan file phase status updates verified for /implement during phase execution
  - [x] command-lifecycle.md Stage 7 updated emphasizing mandatory delegation to status-sync-manager
  - [x] Test: /research task updates TODO.md, state.json, and creates project state.json atomically
  - [x] Test: /plan task updates TODO.md, state.json, project state.json, stores plan_metadata atomically
  - [x] Test: /revise task updates TODO.md, state.json, project state.json, appends to plan_versions atomically
  - [x] Test: /implement task updates TODO.md, state.json, project state.json, plan phase statuses atomically
  - [x] Test: status-sync-manager rollback works - if state.json write fails, TODO.md reverted to original
  - [x] Test: Project state.json exists after any command creates first artifact
  - [x] Test: Plan file contains updated phase statuses after /implement completes phases
  - [x] No "status-sync-manager didn't update TODO.md" errors occur in any workflow
  - [x] No partial updates where some files update and others don't
  - [x] Atomicity guaranteed across all tracking files for all 4 commands
  - [x] Documentation updated with examples of correct status-sync-manager delegation
  - [x] All changes tested with real tasks for each of the 4 commands
- **Impact**: CRITICAL BLOCKER - Fixes comprehensive status update system failures causing "status-sync-manager didn't update TODO.md" errors and similar issues. Ensures atomic updates across all tracking files (TODO.md, state.json, project state.json, plans) via mandatory delegation to status-sync-manager's two-phase commit protocol. Eliminates manual updates that cause partial failures. Enables proper artifact tracking via project state.json lazy creation. Enables plan progress tracking via phase status updates. Delivers 100% atomicity coverage and consistent state across entire system. Essential for reliable task tracking, artifact management, and workflow execution.
