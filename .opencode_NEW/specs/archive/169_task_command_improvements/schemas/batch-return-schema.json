{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://opencode.dev/schemas/batch-task-orchestrator-return.json",
  "title": "Batch Task Orchestrator Return Format",
  "description": "Progressive summarization format for batch task execution. Maximum 50 lines per 10 tasks.",
  "type": "object",
  "required": ["summary", "completed_tasks", "artifacts", "total_files_modified", "status"],
  "properties": {
    "summary": {
      "type": "string",
      "description": "Brief 2-3 sentence summary of batch execution results. Maximum 75 tokens.",
      "maxLength": 400
    },
    "completed_tasks": {
      "type": "array",
      "description": "Array of completed task summaries (brief, not full details)",
      "items": {
        "type": "object",
        "required": ["task_number", "status", "one_line_summary"],
        "properties": {
          "task_number": {
            "type": "integer",
            "minimum": 1
          },
          "status": {
            "type": "string",
            "enum": ["COMPLETED", "FAILED", "BLOCKED", "PARTIAL"]
          },
          "one_line_summary": {
            "type": "string",
            "description": "Single sentence summary of task result",
            "maxLength": 150
          },
          "artifact_path": {
            "type": "string",
            "description": "Path to detailed task summary artifact"
          }
        }
      }
    },
    "artifacts": {
      "type": "object",
      "description": "Aggregated artifact references organized by type",
      "properties": {
        "summary_artifact_path": {
          "type": "string",
          "description": "Path to batch execution summary artifact with full details"
        },
        "task_summaries": {
          "type": "array",
          "description": "Paths to individual task summary artifacts",
          "items": {
            "type": "string"
          }
        },
        "wave_summaries": {
          "type": "array",
          "description": "Paths to wave execution summaries (for large batches)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["summary_artifact_path"]
    },
    "total_files_modified": {
      "type": "integer",
      "description": "Total count of files modified across all tasks",
      "minimum": 0
    },
    "status": {
      "type": "object",
      "description": "Batch execution status summary",
      "required": ["total", "completed", "failed", "blocked"],
      "properties": {
        "total": {
          "type": "integer",
          "description": "Total tasks in batch",
          "minimum": 1
        },
        "completed": {
          "type": "integer",
          "description": "Successfully completed tasks",
          "minimum": 0
        },
        "failed": {
          "type": "integer",
          "description": "Failed tasks",
          "minimum": 0
        },
        "blocked": {
          "type": "integer",
          "description": "Blocked tasks (dependencies not met)",
          "minimum": 0
        },
        "partial": {
          "type": "integer",
          "description": "Partially completed tasks",
          "minimum": 0
        }
      }
    },
    "failed_tasks": {
      "type": "array",
      "description": "Details for failed tasks only (not included for successful tasks)",
      "items": {
        "type": "object",
        "required": ["task_number", "error", "recommendation"],
        "properties": {
          "task_number": {
            "type": "integer",
            "minimum": 1
          },
          "error": {
            "type": "string",
            "description": "Brief error description"
          },
          "recommendation": {
            "type": "string",
            "description": "Recommended action to resolve"
          }
        }
      }
    },
    "next_steps": {
      "type": "string",
      "description": "Brief next steps for batch (1-2 sentences)",
      "maxLength": 200
    },
    "session_id": {
      "type": "string",
      "description": "Unique batch session identifier",
      "pattern": "^batch-[a-z0-9-]+$"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "summary": "Batch execution of 10 tasks completed. 8 tasks succeeded, 1 failed, 1 blocked. Total 42 files modified across all tasks.",
      "completed_tasks": [
        {
          "task_number": 160,
          "status": "COMPLETED",
          "one_line_summary": "Implemented modal logic axioms with soundness proofs",
          "artifact_path": "specs/160_modal_axioms/summaries/implementation-summary.md"
        },
        {
          "task_number": 161,
          "status": "COMPLETED",
          "one_line_summary": "Added temporal logic operators and semantics",
          "artifact_path": "specs/161_temporal_logic/summaries/implementation-summary.md"
        },
        {
          "task_number": 162,
          "status": "FAILED",
          "one_line_summary": "Failed due to missing dependency on task 160",
          "artifact_path": "specs/162_epistemic_logic/summaries/error-report.md"
        }
      ],
      "artifacts": {
        "summary_artifact_path": "specs/batch-160-169/summaries/batch-summary-20251224.md",
        "task_summaries": [
          "specs/160_modal_axioms/summaries/implementation-summary.md",
          "specs/161_temporal_logic/summaries/implementation-summary.md"
        ],
        "wave_summaries": [
          "specs/batch-160-169/summaries/wave-1-summary.md"
        ]
      },
      "total_files_modified": 42,
      "status": {
        "total": 10,
        "completed": 8,
        "failed": 1,
        "blocked": 1,
        "partial": 0
      },
      "failed_tasks": [
        {
          "task_number": 162,
          "error": "Missing dependency: Task 160 must complete first",
          "recommendation": "Re-run task 162 after verifying task 160 completion"
        }
      ],
      "next_steps": "Fix task 162 dependency and re-run. Review blocked task 165 prerequisites.",
      "session_id": "batch-160-169-20251224-001"
    }
  ]
}
