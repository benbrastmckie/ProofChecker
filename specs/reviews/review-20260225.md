# Code Review Report: Post-Cleanup Assessment

**Date**: 2026-02-25
**Scope**: Metalogic completeness chain after tasks 931, 932
**Reviewed by**: Claude
**Focus**: Assess cleanup impact and path to standard representation theorem

## Summary

- Total active sorries in Metalogic: **3** (down from 5+)
- Build status: **Passes** (1001 jobs)
- Cleanup completed: **22+ symbols** removed, **~8,900 lines** archived to Boneyard

## Cleanup Completed

### Task 931: Remove Non-Standard Validity

| Item | Count |
|------|-------|
| `_mcs` symbols removed | 14 |
| `eval_bmcs_*` symbols removed | 8 |
| Lines archived | 484 |
| Target file | ChainBundleBFMCS.lean (moved to Boneyard) |

**Result**: No more MCS-membership box semantics in active codebase.

### Task 932: Remove Constant Witness Family

| Item | Count |
|------|-------|
| Files archived | 4 |
| Lines archived | ~8,580 |
| Deprecated axiom | Removed from trusted kernel |

**Result**: No more constant witness family approach in active codebase.

## Remaining Sorries (Critical for Standard Completeness)

Only **3 actual sorries** remain in the completeness chain:

| File | Line | Purpose | Impact |
|------|------|---------|--------|
| DovetailingChain.lean | 1869 | `forward_F` for dovetailing chain | Blocks temporal coherence over Int |
| DovetailingChain.lean | 1881 | `backward_P` for dovetailing chain | Blocks temporal coherence over Int |
| TemporalCoherentConstruction.lean | 600 | `fully_saturated_bfmcs_exists_int` | Blocks standard representation |

**Root cause**: F-formulas don't persist through GContent seeds in the dovetailing construction.

## Current State: Two Completeness Chains

### Chain A (BMCS Completeness) - SORRY-FREE

| Theorem | Status | Location |
|---------|--------|----------|
| `bmcs_representation` | PROVEN | Completeness.lean |
| `bmcs_weak_completeness` | PROVEN | Completeness.lean |
| `bmcs_strong_completeness` | PROVEN | Completeness.lean |
| `bmcs_truth_lemma` | PROVEN | TruthLemma.lean |

**Validity notion**: `bmcs_valid` (BFMCS validity, Preorder D)

### Chain B (Standard Completeness) - BLOCKED

| Theorem | Status | Blocker |
|---------|--------|---------|
| `standard_weak_completeness` | SORRY | `fully_saturated_bfmcs_exists_int` |
| `standard_strong_completeness` | SORRY | `fully_saturated_bfmcs_exists_int` |

**Validity notion**: `valid` (standard semantics, LinearOrderedAddCommGroup D)

## Gap: BMCS Validity vs Standard Validity

### Definition Comparison

```lean
-- BMCS Validity (current completeness)
def bmcs_valid (φ : Formula) : Prop :=
  ∀ BC B (fam : FMCS _) (hfam : fam ∈ B.families) (t : _),
    bmcs_truth_at B fam t φ

-- Standard Validity (target)
def valid (φ : Formula) : Prop :=
  ∀ (D : Type) [AddCommGroup D] [LinearOrder D] [IsOrderedAddMonoid D]
    (F : TaskFrame D) (M : TaskModel F)
    (Omega : Set (WorldHistory F)) (h_sc : ShiftClosed Omega)
    (τ : WorldHistory F) (h_mem : τ ∈ Omega) (t : D),
    truth_at M Omega τ t φ
```

### Why Bridge Is Hard

1. **D type mismatch**: BMCS uses `CanonicalBC BC` (Preorder), standard uses Int (LinearOrderedAddCommGroup)
2. **Temporal coherence**: Building temporally coherent FMCS over Int requires solving F-witness persistence
3. **Contrapositive argument**: Standard completeness is `¬⊢φ → ¬valid φ`, requiring a countermodel over proper D

## Recommended Path Forward

### Option 1: Solve DovetailingChain Sorries (Direct)

**Goal**: Prove `forward_F` and `backward_P` for dovetailing chain over Int

**Challenge**: F-formulas don't persist through GContent seeds

**Potential approach**: ω² construction - enumerate obligations across two dimensions

### Option 2: Alternative Canonical Model (Indirect)

**Goal**: Different canonical construction that avoids F-formula persistence issue

**Approaches researched**:
- Tree unraveling (exponential blowup)
- Quotient construction (loses temporal structure)
- Omega-step enumeration (current approach, stuck on F-persistence)

### Option 3: Weaken Standard Validity (Pragmatic)

**Goal**: Prove completeness for a restricted class of models

**Example**: Non-shift-closed Omega, specific TaskFrame structure

**Trade-off**: Less general but may be provable

## Files to Focus On

| Priority | File | Purpose |
|----------|------|---------|
| **Critical** | DovetailingChain.lean | Fix forward_F/backward_P sorries |
| **High** | TemporalCoherentConstruction.lean | Understand what's needed |
| **Reference** | CanonicalFMCS.lean | Working FMCS over CanonicalMCS (Preorder) |
| **Target** | Semantics/Validity.lean | Standard validity definition |

## Recommendations

1. **Focus on DovetailingChain.lean:1869-1881** - These 2 sorries are the crux
2. **Study CanonicalFMCS.lean** - It achieves temporal coherence for D = CanonicalMCS by exploiting that witness MCS IS a new time point
3. **Consider ω² enumeration** - Interleave F-obligation enumeration with forward chain construction
4. **Do NOT attempt new bridge lemmas** - Research 930 showed this doesn't work

## Metrics

| Metric | Value | Status |
|--------|-------|--------|
| Sorry count (Metalogic active) | 3 | Good |
| Axiom count | 0 | Excellent |
| Build status | Pass | Good |
| Critical sorries | 2 in DovetailingChain | Focus here |
